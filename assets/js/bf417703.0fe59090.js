"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[571],{4908:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Usage","title":"Usage","description":"In PakNet, creating remotes involves setting up network modules within ReplicatedStorage. These modules return a mounted namespace of remotes that can be accessed and used in your game.","source":"@site/docs/Usage.md","sourceDirName":".","slug":"/Usage","permalink":"/PakNet/docs/Usage","draft":false,"unlisted":false,"editUrl":"https://github.com/isoopod/PakNet/edit/main/docs/Usage.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"defaultSidebar","previous":{"title":"Installation","permalink":"/PakNet/docs/Installation"}}');var r=t(4848),s=t(8453);const a={sidebar_position:3},l="Usage",o={},c=[{value:"Creating Remotes",id:"creating-remotes",level:2},{value:"Organizational Tips",id:"organizational-tips",level:3},{value:"Defining Remotes",id:"defining-remotes",level:3},{value:"Using Remotes",id:"using-remotes",level:2},{value:"Key Changes",id:"key-changes",level:3},{value:"Access Based on Remote Type",id:"access-based-on-remote-type",level:3},{value:"Common Access",id:"common-access",level:3},{value:"Bulk Protection",id:"bulk-protection",level:3}];function d(e){const n={admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"usage",children:"Usage"})}),"\n",(0,r.jsxs)(n.p,{children:["In PakNet, creating remotes involves setting up network modules within ",(0,r.jsx)(n.code,{children:"ReplicatedStorage"}),". These modules return a mounted namespace of remotes that can be accessed and used in your game."]}),"\n",(0,r.jsx)(n.h2,{id:"creating-remotes",children:"Creating Remotes"}),"\n",(0,r.jsxs)(n.p,{children:["To create remotes, you'll need to use the ",(0,r.jsx)(n.code,{children:"PakNet:Mount"})," function. This function mounts a remote namespace, where each remote is a key-value pair that represents a remote definition."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"PakNet:Mount(file: Instance, namespace: RemoteTable)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"file"}),": The ",(0,r.jsx)(n.code,{children:"Instance"})," where remote instances will be created (usually ",(0,r.jsx)(n.code,{children:"script"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"namespace"}),": A table that holds the remote definitions."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Do not mount multiple namespaces to the same file. This can cause name collisions and break everything \u2014 even if the namespaces don't overlap."})}),"\n",(0,r.jsx)(n.h3,{id:"organizational-tips",children:"Organizational Tips"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Typically, you'll mount the remote directly to the current script."}),"\n",(0,r.jsx)(n.li,{children:"If you want to create multiple namespaces within a single script for better organization, create folders under the module for each namespace and mount to those."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"defining-remotes",children:"Defining Remotes"}),"\n",(0,r.jsx)(n.p,{children:"A remote table is essentially a map where each key is the remote name, and the value is the remote's definition. To define a remote, use:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"PakNet:DefineRemote(settings: RemoteSettings)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"RemoteSettings"})," is a dictionary with the following fields:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"params"})," ",(0,r.jsx)(n.em,{children:"(required)"}),(0,r.jsx)(n.br,{}),"\n","A PakNet schema that defines the parameters for the remote."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"returns"})," ",(0,r.jsx)(n.em,{children:"(required for remote functions only)"}),(0,r.jsx)(n.br,{}),"\n","A PakNet schema that defines the return values for the remote function."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"remoteType"})," ",(0,r.jsx)(n.em,{children:"(required)"}),(0,r.jsx)(n.br,{}),"\n","A string specifying the type of remote. Valid values:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"f"'})," \u2013 RemoteFunction"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"r"'})," \u2013 RemoteEvent"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"u"'})," \u2013 UnreliableRemoteEvent"]}),"\n",(0,r.jsxs)(n.li,{children:["Combinations are allowed (e.g. ",(0,r.jsx)(n.code,{children:'"fr"'}),", ",(0,r.jsx)(n.code,{children:'"fu"'}),", ",(0,r.jsx)(n.code,{children:'"ru"'}),", ",(0,r.jsx)(n.code,{children:'"fru"'}),"). The letters must always appear in alphabetical order."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"rateLimit"})," ",(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)(n.br,{}),"\n","A table that specifies rate limiting for the remote."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"global"})," (boolean): If true, the limit applies globally. If false or omitted, it applies per player."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"limit"})," (number): Maximum number of requests allowed within the window."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"window"})," (number): Duration of the window in seconds."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"timeout"})," ",(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)(n.br,{}),"\n","A number (seconds) specifying the timeout for remote functions. If exceeded, the call is cancelled and returns ",(0,r.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",metastring:'title="networkExample.luau"',children:'local PakNet = require(path.to.PakNet)\n\n-- We will mount this namespace on the current script\nlocal namespace = PakNet:Mount(script, {\n    -- The name of the remote is the key, and the value is a remote configuration, created with PakNet:DefineRemote()\n    SomeRemoteEvent = PakNet:DefineRemote({\n        -- params is a schema defining how to read and write the packet.\n        -- PakNet:Schema is used the same as Pack:Define\n        params = PakNet:Schema(PakNet.String16),\n        -- remoteType is a string telling PakNet what instances we need for the remote\n        -- If it contains "r", a RemoteEvent will be created\n        remoteType = "r",\n    }),\n\n    SomeUnreliableEvent = PakNet:DefineRemote({\n        -- If we are using a tuple schema, we have to assert the type due to luau being unable to capture the generic pack\n        -- Hovering over the datatype will show you what the type is defined at if you are unsure\n        params = PakNet:Schema(PakNet.Float64, PakNet.Vector3) :: PakNet.Schema<number, vector>,\n        -- If remoteType contains "u", an UnreliableRemoteEvent will be created\n        remoteType = "u",\n        -- We can attach a ratelimit to our remote, to prevent it being spammed\n        rateLimit = {\n            limit = 60, -- Allows 60 requests\n            window = 3, -- per 3 seconds \n        },\n    }),\n\n    SomeRemoteFunction = PakNet:DefineRemote({\n        params = PakNet:Schema(PakNet.Array(PakNet.Double)),\n        -- When we have a remote function, we have to specify the return schema as well\n        returns = PakNet:Schema(PakNet.UInt),\n        -- If remoteType contains "f", a RemoteFunction will be created\n        remoteType = "f",\n        -- We can set a timeout for remote functions, after which requests will be cancelled and nil will be returned\n        timeout = 5,\n    }),\n\n    SomeEverythingEvent = PakNet:DefineRemote({\n        -- Heres an example of a more complex schema\n        params = PakNet:Schema(PakNet.Dictionary({\n            Name = PakNet.String16,\n            Level = PakNet.UInt,\n            CFrame = PakNet.CFrame,\n            Buildings = PakNet.Map(PakNet.Vector3, PakNet.Instance),\n        })),\n        returns = PakNet:Schema(PakNet.Array(PakNet.nullable(PakNet.Double))),\n        -- We can combine remote types, but they must be in alphabetical order\n        -- For example you could also use "fr" "fu" or "ru"\n        remoteType = "fru",\n        rateLimit = {\n            limit = 10, -- Allows 10 requests\n            window = 1, -- per second\n        },\n        timeout = 15,\n    }),\n})\n\n-- You can pass through the global signal function, if you find that useful\n-- Nice if you have a centralized network module, rarther than many separate namespaces\nnamespace.Signal = PakNet:LoadGlobalSignal()\n\nreturn namespace\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.p,{children:["When defining a tuple Schema (one with multiple arguments), you have to assert the type as ",(0,r.jsx)(n.code,{children:"PakNet.Schema<...>"})]}),(0,r.jsxs)(n.p,{children:["When you have complicated data structures, it can be annoying to convert them into standard types.\nYou can copy the definition inside the function and surround it in ",(0,r.jsx)(n.code,{children:"typeof()"})," instead of writing it out with types as well."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:" params = PakNet:Schema(PakNet.Dictionary({\n    Name = PakNet.String16,\n    Level = PakNet.UByte,\n}, PakNet.Int)) :: PakNet.Schema<typeof(PakNet.Dictionary({\n    Name = PakNet.String16,\n    Level = PakNet.UByte,\n}), typeof(PakNet.Int)>\n"})})]}),"\n",(0,r.jsx)(n.p,{children:"How you organize namespaces is up to you. You might want to create a centralized network module with all remotes inside it, or you might want to create multiple network modules for different things."}),"\n",(0,r.jsx)(n.h2,{id:"using-remotes",children:"Using Remotes"}),"\n",(0,r.jsx)(n.p,{children:"Remotes in PakNet have a unified API that combines both server and client functionality. There are some deviations to the RemoteEvent/RemoteFunction API to simplify naming conventions and add new features."}),"\n",(0,r.jsx)(n.h3,{id:"key-changes",children:"Key Changes"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Unified API"}),(0,r.jsx)(n.br,{}),"\n","Remote methods for server and client are now combined under consistent names:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireClient"})," \u2192 ",(0,r.jsx)(n.code,{children:"Fire"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnServerEvent"})," \u2192 ",(0,r.jsx)(n.code,{children:"OnEvent"}),"\n(Client-side names remain unchanged.)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Server-only additions"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AddSanityCheck"}),": Attach sanity checks directly to a remote."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireList"}),": Send to a list of players."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireExcept"}),": Send to all players except the given ones."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnCheckFail"}),": Triggered when a packet fails sanity checks."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnParseError"}),": Triggered when a packet cannot be deserialized."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Async methods"}),(0,r.jsx)(n.br,{}),"\n","Available on both server and client:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InvokeAsync"})," (server)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InvokeServerAsync"})," (client)\nThese are non-blocking versions of ",(0,r.jsx)(n.code,{children:"Invoke"})," and return a Promise."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Rate limiting"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnRateLimited"}),": Triggered when a player exceeds the configured limit."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Unreliable variants"}),(0,r.jsx)(n.br,{}),"\n","All ",(0,r.jsx)(n.code,{children:"Fire"})," methods have unreliable counterparts that use ",(0,r.jsx)(n.code,{children:"UnreliableRemoteEvent"})," instead of ",(0,r.jsx)(n.code,{children:"RemoteEvent"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"access-based-on-remote-type",children:"Access Based on Remote Type"}),"\n",(0,r.jsx)(n.p,{children:"The parts of the API you can use depend on whether you\u2019re on the server or client and the Remote's type."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"f" (Functions)'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnInvoke"})," The server-side callback that will run when a client invokes the server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnClientInvoke"})," The client-side callback that will run when the server invokes a client."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Invoke"})," Invokes a client from the server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InvokeAsync"})," Promisified version of ",(0,r.jsx)(n.code,{children:"Invoke"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InvokeServer"})," Invokes the server from a client."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"InvokeServerAsync"})," Promisified version of ",(0,r.jsx)(n.code,{children:"InvokeServer"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"r" (Remote)'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnEvent"})," Server-side signal."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnClientEvent"})," Client-side signal."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Fire"})," Fires from the server to a single player."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireAll"})," Fires from the server to all players."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireList"})," Fires from the server to a list of players."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireExcept"})," Fires from the server to all players except those in the list."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireServer"})," Fires from the client to the server."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"u" (Unreliable)'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnEvent"})," Server-side signal."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OnClientEvent"})," Client-side signal."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireUnreliable"})," Fires unreliably from the server to a single player."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireAllUnreliable"})," Fires unreliably from the server to all players."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireListUnreliable"})," Fires unreliably from the server to a list of players."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireExceptUnreliable"})," Fires unreliably from the server to all players except those in the list."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FireServerUnreliable"})," Fires unreliably from the client to the server."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"common-access",children:"Common Access"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server"})," always has access to the ",(0,r.jsx)(n.code,{children:"OnParseError"})," and ",(0,r.jsx)(n.code,{children:"OnCheckFailed"})," events."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Both server and client"})," always have access to the ",(0,r.jsx)(n.code,{children:"OnRateLimited"})," event and the ",(0,r.jsx)(n.code,{children:"ClassName"}),' property (which indicates whether the current context is "Server" or "Client").']}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",metastring:'title="Example.server.luau"',children:'local network = require(game:GetService("ReplicatedStorage"):WaitForChild("networkExample"))\n\n-- A big benefit of schemas is that you get proper typings, so message will default to string in this example\nnetwork.SomeRemoteEvent.OnEvent:Connect(function(message)\n    print(message)\n    -- >>> Hello World!\nend)\n\nnetwork.SomeUnreliableEvent.OnEvent:Connect(function(num, vector)\n    print(num)\n    -- The client ratelimit will stop it at 60\n    -- >>> 1 ... 60\nend)\n\nnetwork.SomeEverythingEvent.OnInvoke = function(player, data)\n    print(data)\n    --[[ >>>{\n                ["Buildings"] = {},\n                ["CFrame"] = 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1,\n                ["Level"] = 9001,\n                ["Name"] = "Bob"\n            }\n    ]]\n    \n    return data.Level\nend\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",metastring:'title="Example.client.luau"',children:'local network = require(game:GetService("ReplicatedStorage"):WaitForChild("networkExample"))\n\nnetwork.SomeRemoteEvent:FireServer("Hello World!")\n\n-- Send SomeUnreliableEvent faster than the rate limit\nnetwork.SomeUnreliableEvent.OnRateLimited:Connect(function()\n    print("Rate Limited")\n    -- >>> Rate Limited (x40)\nend)\n\nfor i = 1, 100 do\n    network.SomeUnreliableEvent:FireServerUnreliable(i, Vector3.new(i, i, i))\nend\n\nprint(network.SomeEverythingEvent:InvokeServer({\n    Name = "Bob",\n    Level = 9001,\n    CFrame = CFrame.identity,\n    Buildings = {},\n}))\n-- >>> 9001\n'})}),"\n",(0,r.jsx)(n.h3,{id:"bulk-protection",children:"Bulk Protection"}),"\n",(0,r.jsxs)(n.p,{children:["Setting up ",(0,r.jsx)(n.code,{children:"OnRateLimited"})," and other security events individually for each remote can quickly become tedious. Instead, you can apply protections to an entire namespace at once by iterating over it."]}),"\n",(0,r.jsxs)(n.p,{children:["When iterating a mounted namespace, only remotes are returned \u2014 you don't need to worry about filtering out extra entries like ",(0,r.jsx)(n.code,{children:"Signal"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",metastring:'title="BulkProtection.server.luau"',children:'local network = require(game:GetService("ReplicatedStorage"):WaitForChild("networkExample"))\n\n-- This example just kicks the player\n-- You may want to hook this up to a proper ban system\nfor name, remote in network do\n    remote.OnRateLimited:Connect(function(player)\n        player:Kick("Attempted to bypass rate limit")\n    end)\n\n    remote.OnParseError:Connect(function(player)\n        player:Kick("Sent invalid packet")\n    end)\n\n    remote.OnCheckFail:Connect(function(player, error)\n        warn(`{player} Triggered a sanity check for {name}: {error}`)\n        player:Kick("Tripped a sanity check")\n    end)\nend\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Never store sanity checks or other protections inside the module that creates the namespace \u2014 or anywhere the client has access to.",(0,r.jsx)(n.br,{}),"\n","Always keep security logic server-side and isolated."]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);